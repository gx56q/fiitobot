# Идеи

* Выводить список половинки группы
* Понимать сокращённые имена: Ваня, Саша, Лёня ← реальные примеры из логов бота
* Автокик из чата не ФИИТов?
* Случайный кофе?
* Фото игра?


# Документация

## Что где хранится

Все данные для бота хранятся в S3 хранилище в следующем виде:

1. data.json − список контактов, с основной инфой без деталей (класс Contact).
Этот файл обновляется ТОЛЬКО при выполнении команды /reload.

2. contact-<contactId>.json − детали по этому контакту (класс ContactDetails).
В частности все оценки, выгруженные из БРС.
Когда понадобится, тут можно сохранять состояние диалога.
Этот файл может обновляться когда угодно.
В частности, каждый раз, когда чел из списка известных контактов пишет боту, он обновляет TgName, TgId и
LastUpdateTime, в ContactDetails.
В частности, команда /scores обновляет оценки из БРС.

3. for-moderation-<tgId>.jpeg и moderated-<tgId>.jpeg — фотка для модерации и отмодерированная.
В качестве идентификатора тут tgId, по историческим причинам. Надо бы переделать на contactId,
чтобы фотки переживали смену аккаунта в телеграме.

## Загрузка данных из внешних источников

Бот умеет загружать контакты из гугл-таблицы с помощью команды /reload − это его основной источник данных.
Есть несколько тонких моментов:

1. Сценарий "Исправляем ошибку в таблице".
Если у пользователя поменялся tgUsername в таблице, и оно не совпадает с именем,
сохранённым в Details, то надо забыть TgId из Details и сохранить там новое tgUsername.

2. Если у пользователя TgId == 0, то надо взять TgId из Details и записать в таблицу.

3. (TODO) После загрузки из гуглтаблицы, бот загружает данные по студентам из ИТС.
Если у студентов обновились статус, группа или рейтинг, то он обновляет эти данные в гуглтаблице.
Если появились новые студенты, он заносит их в таблицу.

4. (TODO) Если из ИТС пришли какие-то изменения статусов студентов или появились новые студенты,
то фиитобот форвардит сообщение об этом в чат команды ФИИТ.
